<div style="width: 1350px; margin-left: auto; margin-right: auto; margin-bottom: 0; padding-bottom: 0">

  <div style="width: 1350px; margin: 0; padding: 0">
    <table style="font-size: 13px" class="table is-bordered has-text-centered">
      <thead class="has-text-centered">
      <th class="has-text-centered">优化段数前(常规压裂)</th>
      <th class="has-text-centered">优化段数后(零桥塞压裂TM)</th>
      </thead>
      <tbody>
      <tr>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="25"></td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="13"></td>
      </tr>
      </tbody>
    </table>
  </div>

  <div style="width: 1350px; margin: 0; padding: 0">
    <table style="font-size: 13px" class="table is-bordered has-text-centered">
      <thead class="has-text-centered">
      <th class="has-text-centered">item</th>
      <th class="has-text-centered">单价</th>
      <th class="has-text-centered">单位</th>
      <th class="has-text-centered">数量</th>
      </thead>
      <tbody>
      <tr>
        <td>压裂车费用</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="0.95"></td>
        <td>万元/台/段</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="24"></td>
      </tr>
      <tr>
        <td>混砂车费用</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="0.6"></td>
        <td>万元/台/段</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="21"></td>
      </tr>
      <tr>
        <td>仪表车</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="0.3"></td>
        <td>万元/台/段</td>
        <td></td>
      </tr>
      <tr>
        <td>桥射联作费用</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="8"></td>
        <td>万元/段</td>
        <td></td>
      </tr>
      <tr>
        <td>连油钻塞费用</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="3.1"></td>
        <td>万元/个</td>
        <td></td>
      </tr>
      <tr>
        <td>桥塞费用</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="1.1"></td>
        <td>万元/个</td>
        <td></td>
      </tr>
      <tr>
        <td>压裂施工速度</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="2.5"></td>
        <td>段/天</td>
        <td></td>
      </tr>
      <tr>
        <td>桥射联作耗时</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="3"></td>
        <td>小时/段</td>
        <td></td>
      </tr>
      <tr>
        <td>桥塞遇阻,提前坐封概率</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="1"></td>
        <td>%/趟</td>
        <td></td>
      </tr>
      <tr>
        <td>射孔枪点火失败概率</td>
        <td><input class="input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="1"></td>
        <td>%/趟</td>
        <td></td>
      </tr>
      </tbody>
    </table>
  </div>

  <div style="width: 1350px; margin: 0; padding: 0">
    <table style="font-size: 13px" class="table is-bordered has-text-centered">
      <thead class="has-text-centered">
      <th class="has-text-centered">段数减少</th>
      <th class="has-text-centered">费用减少</th>
      <th class="has-text-centered">施工时间减少</th>
      <th class="has-text-centered">桥射联作风险降低(遇阻,提前坐封,点火失败)</th>
      </thead>
      <tbody>
      <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
      </tr>
      </tbody>
    </table>
  </div>

</div>

<div style="width: 1350px; margin-left: auto; margin-right: auto; margin-top: 0; padding-top: 0">
  <div id="calculatorPie" style="height: 450px;width: 1300px; margin-left: 50px; margin-bottom: 0; padding-bottom: 0; margin-top: 0; padding-top: 0" />
</div>
<div style="width: 1350px; margin-left: auto; margin-right: auto; margin-top: 0; padding-top: 0">
  <table class="table is-bordered" style="font-size: 13px; margin-top: 0; padding-top: 0" >
    <thead>
      <th style="width: 180px"></th>
      <th style="width: 150px">压裂段数</th>
      <th style="width: 150px">压裂费用</th>
      <th style="width: 140px">桥射联作费用</th>
      <th style="width: 140px">连油钻塞费用</th>
      <th style="width: 150px">桥塞费用</th>
      <th style="width: 130px">压裂施工周期</th>
      <th style="width: 170px">每次异常事件发生概率-桥塞遇阻或提前坐封</th>
      <th>每次异常事件发生概率-射孔枪点火失败</th>
    </thead>
    <tbody>
    <tr>
      <td>优化段数前(常规压裂)</td>
      <td id="td2-before-压裂段数">25</td>
      <td id="td2-before-压裂费用">593</td>
      <td id="td2-before-桥射联作费用">192</td>
      <td id="td2-before-连油钻塞费用">74</td>
      <td id="td2-before-桥塞费用">26</td>
      <td id="td2-before-压裂施工周期">10.0</td>
      <td id="td2-before-桥塞遇阻或提前坐封概率">21</td>
      <td id="td2-before-射孔枪点火失败概率">21</td>
    </tr>
    <tr>
      <td>优化段数后(零桥塞压裂TM)</td>
      <td id="td2-after-压裂段数">13</td>
      <td id="td2-after-压裂费用">308</td>
      <td id="td2-after-桥射联作费用">96</td>
      <td id="td2-after-连油钻塞费用">37</td>
      <td id="td2-after-桥塞费用">13</td>
      <td id="td2-after-压裂施工周期">8.5</td>
      <td id="td2-after-桥塞遇阻或提前坐封概率">11</td>
      <td id="td2-after-射孔枪点火失败概率">11</td>
    </tr>
    </tbody>
  </table>
</div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
<script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script>
  const showMsgOk = (text) => (new Notyf({position: {x:'right',y:'top'}})).success(text);
  const showMsgErr = (text) => (new Notyf({position: {x:'right',y:'top'}})).error(text);
  const FORM_DATA = {
    field_原设计中的压裂段数: 25,
    field_合并缩减_优化后的压裂段数: 15,
    field_压裂车费用_N_1: 0.95,
    field_压裂车费用_N_2: 24,
    field_混砂车费用_N_1: 0.6,
    field_混砂车费用_N_2: 1,
    field_仪表车费用_N_1: 0.3,
    field_仪表车费用_N_2: 1,
    field_桥射联作费用_N_1: 8,
    field_桥射联作费用_N_2: 1,
    field_连油钻塞费用_N_1: 3.1,
    field_连油钻塞费用_N_2: 1,
    field_桥塞费用_N_1: 1.1,
    field_桥塞费用_N_2: 1,
    field_压裂施工速度_N_1: 2.5,
    field_压裂施工速度_N_2: 1,
    field_桥射联作平均耗时_N_1: 4,
    field_桥射联作平均耗时_N_2: 1,
    field_桥塞遇阻或提前坐封概率_N_1: 1,
    field_桥塞遇阻或提前坐封概率_N_2: 1,
    field_射孔枪点火失败概率_N_1: 0.1,
    field_射孔枪点火失败概率_N_2: 1,
  };
  const CHART_DATA = {
    beforeOptimized: {
      field_压裂段数: 0,
      field_压裂费用: 0,
      field_桥射联作费用: 0,
      field_连油钻塞费用: 0,
      field_桥塞费用: 0,
      field_压裂施工周期: 0,
      field_桥塞遇阻提前坐封概率: 0,
      field_射孔枪点火失败概率: 0
    },
    afterOptimized: {
      field_压裂段数: 0,
      field_压裂费用: 0,
      field_桥射联作费用: 0,
      field_连油钻塞费用: 0,
      field_桥塞费用: 0,
      field_压裂施工周期: 0,
      field_桥塞遇阻提前坐封概率: 0,
      field_射孔枪点火失败概率: 0
    }
  };
  const beforeOptimized = () => Object.values(CHART_DATA.beforeOptimized);
  const afterOptimized = () => Object.values(CHART_DATA.afterOptimized);

  const setFormData = (k, v) => {
    FORM_DATA[k] = v;
    drawBarChart();
    refreshResultTable();
  };

  const refreshResultTable = () => {
    CHART_DATA.beforeOptimized.field_压裂段数 = FORM_DATA.field_原设计中的压裂段数;
    CHART_DATA.afterOptimized.field_压裂段数 = FORM_DATA.field_合并缩减_优化后的压裂段数;
    $('#td2-before-压裂段数').text(CHART_DATA.beforeOptimized.field_压裂段数);
    $('#td2-before-压裂费用').text(CHART_DATA.beforeOptimized.field_压裂费用);
    $('#td2-before-桥射联作费用').text(CHART_DATA.beforeOptimized.field_桥射联作费用);
    $('#td2-before-连油钻塞费用').text(CHART_DATA.beforeOptimized.field_连油钻塞费用);
    $('#td2-before-桥塞费用').text(CHART_DATA.beforeOptimized.field_桥塞费用);
    $('#td2-before-压裂施工周期').text(CHART_DATA.beforeOptimized.field_压裂施工周期);
    $('#td2-before-桥塞遇阻或提前坐封概率').text(CHART_DATA.beforeOptimized.field_桥塞遇阻提前坐封概率);
    $('#td2-before-射孔枪点火失败概率').text(CHART_DATA.beforeOptimized.field_射孔枪点火失败概率);
    $('#td2-after-压裂段数').text(CHART_DATA.afterOptimized.field_压裂段数);
    $('#td2-after-压裂费用').text(CHART_DATA.afterOptimized.field_压裂费用);
    $('#td2-after-桥射联作费用').text(CHART_DATA.afterOptimized.field_桥射联作费用);
    $('#td2-after-连油钻塞费用').text(CHART_DATA.afterOptimized.field_连油钻塞费用);
    $('#td2-after-桥塞费用').text(CHART_DATA.afterOptimized.field_桥塞费用);
    $('#td2-after-压裂施工周期').text(CHART_DATA.afterOptimized.field_压裂施工周期);
    $('#td2-after-桥塞遇阻或提前坐封概率').text(CHART_DATA.afterOptimized.field_桥塞遇阻提前坐封概率);
    $('#td2-after-射孔枪点火失败概率').text(CHART_DATA.afterOptimized.field_射孔枪点火失败概率);
    drawBarChart()
  };

  const drawBarChart = () => {
    const cht = echarts.init(document.getElementById('calculatorPie'));
    const option = {
      grid: {bottom: '0', right: '0'},
      legend: {
        data: ['优化段数前(常规压裂)', '优化段数后(零桥塞压裂TM)'],
        orient: 'vertical',
        top: 0,
        right: 50,
      },
      xAxis: {
        show: false,
        type: 'category',
        nameTextStyle: {fontSize: 3},
        nameGap: 3,
        axisLabel: {interval: 0},
        data: ['压裂段数', '压裂费用(万元)', '桥射联作费用(万元)', '连油钻塞费用(万年)', '桥塞费用(万元)', '压裂施工周期(万元)', '桥塞遇阻,提前坐封概率', '射孔枪点火失败概率']
      },
      yAxis: {show: false},
      series: [
        {
          name: '优化段数前(常规压裂)',
          type: 'bar',
          data: beforeOptimized(),
          barGap: '5%',
          barWidth: '25%',
          itemStyle: {color: '#747474'},
        },
        {
          name: '优化段数后(零桥塞压裂TM)',
          type: 'bar',
          data: afterOptimized(),
          barGap: '5%',
          barWidth: '25%',
          itemStyle: {color: '#0057a7'},
        },
      ]
    };
    cht.setOption(option);
  };
  refreshResultTable()
</script>
