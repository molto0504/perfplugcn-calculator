<div id="capture" style="background-color: #000000;font-family: 'Jost', sans-serif;">
  <div style="width: 1350px; margin-left: auto; margin-right: auto; margin-bottom: 0; padding-bottom: 0; margin-top: 0; padding-top: 0">

    <div id="table-1" style="width: 1350px; margin: 0; padding: 0">
      <table style="font-size: 13px" class="bn table is-bordered has-text-centered">
        <thead class="has-text-centered">
          <th class="bn has-text-centered">原设计中的压裂段数(常规压裂)</th>
          <th class="bn has-text-centered">合并缩减/优化后的压裂段数("零"桥塞压裂&trade;)</th>
        </thead>
        <tbody>
        <tr>
          <td class="bn" style="margin: 0; padding: 0;">
            <input id="form-data-原设计中的压裂段数"
                   name="原设计中的压裂段数"
                   class="only-int input is-small has-text-centered"
                   style="margin: 0;padding: 0;text-align: center;color: #03a7ee;height: 30px;font-weight: bold"
                   type="text"
                   placeholder="请输入" value="25">
          </td>
          <td class="bn">
            <input id="form-data-合并缩减-优化后的压裂段数"
                   name="合并缩减-优化后的压裂段数"
                   class="only-int input is-small has-text-centered"
                   style="margin: 0;padding: 0;text-align: center;color: #03a7ee;height: 30px;font-weight: bold"
                   type="text"
                   placeholder="请输入" value="15">
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <div id="control-panel" style="width: 1350px; margin: 0; padding: 0">
      <div class="columns" style="margin: 0; padding: 0 0 8px 0">
        <button
                id="btn-setting"
                class="btn btn-warning display-4 animate__animated animate__delay-1s animate__fadeInUp"
                style="border-radius: 100px"
        >更多参数设置
        </button>
      </div>
    </div>

    <div id="table-2" style="width: 1350px; margin: 0; padding: 0;display: none">
      <table style="font-size: 13px" class="ba bl-0 br-0 bb-0 b--black table is-bordered has-text-centered">
        <thead class="has-text-centered">
          <th class="bn has-text-centered" style="padding: 0">更多参数</th>
          <th class="bn has-text-centered" style="padding: 0">值</th>
          <th class="bn has-text-centered" style="padding: 0">数量</th>
        </thead>
        <tbody>
        <tr>
          <td class="bn" style="padding: 0">压裂车费用</td>
          <td class="bn" style="padding: 0">
            <input id="form-data-压裂车费用-N-1" name="压裂车费用-值" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                   placeholder="请输入" value="0.95">
          </td>
          <td class="bn" style="padding: 0">
            <input  id="form-data-压裂车费用-N-2" name="压裂车费用-数量" class="only-int input is-small has-text-centered" style="background-color: #e3f4eb" type="text" placeholder="请输入" value="24">
          </td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">混砂车费用</td>
          <td class="bn" style="padding: 0"><input id="form-data-混砂车费用-N-1" name="混砂车费用-值" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="0.6"></td>
          <td class="bn" style="padding: 0"><input id="form-data-混砂车费用-N-2" name="混砂车费用-费用" class="only-int input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="1"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">仪表车</td>
          <td class="bn" style="padding: 0"><input id="form-data-仪表车费用-N-1" name="仪表车费用" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="0.3"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">桥射联作费用</td>
          <td class="bn" style="padding: 0"><input id="form-data-桥射联作费用-N-1" name="桥射联作费用" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="8"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">连油钻塞费用</td>
          <td class="bn" style="padding: 0"><input id="form-data-连油钻塞费用-N-1" name="连油钻塞费用" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="3.1"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">桥塞费用</td>
          <td class="bn" style="padding: 0"><input id="form-data-桥塞费用-N-1" name="桥塞费用" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="1.1"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">压裂施工速度</td>
          <td class="bn" style="padding: 0"><input id="form-data-压裂施工速度-N-1" name="压裂施工速度" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="2.5"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">桥射联作耗时</td>
          <td class="bn" style="padding: 0"><input id="form-data-桥射联作平均耗时-N-1" name="桥射联作平均耗时" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="4"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">桥塞遇阻,提前坐封概率</td>
          <td class="bn" style="padding: 0"><input id="form-data-桥塞遇阻或提前坐封概率-N-1" name="桥塞遇阻或提前坐封概率" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="1"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        <tr>
          <td class="bn" style="padding: 0">射孔枪点火失败概率</td>
          <td class="bn" style="padding: 0"><input id="form-data-射孔枪点火失败概率-N-1" name="射孔枪点火失败概率" class="only-num input is-small has-text-centered" style="background-color: #e3f4eb" type="text"
                     placeholder="请输入" value="0.1"></td>
          <td class="bn" style="padding: 0"></td>
        </tr>
        </tbody>
      </table>
    </div>

    <div id="table-3" style="width: 1350px; margin: 0; padding: 0">
      <table style="font-size: 13px; margin: 0; padding: 0" class="bn b--black dt--fixed table is-bordered has-text-centered">
        <thead class="has-text-centered">
        <th class="bn has-text-centered" style="padding: 0">段数减少</th>
        <th class="bn has-text-centered" style="padding: 0">费用减少</th>
        <th class="bn has-text-centered" style="padding: 0">施工时间减少</th>
        <th class="bn has-text-centered" style="padding: 0">桥射联作风险降低(遇阻,提前坐封,点火失败)</th>
        </thead>
        <tbody>
        <tr>
          <td class="bn" id="td3-段数减少" style="padding: 0;font-size: 20px;color:#03a7ee;font-weight: bold"></td>
          <td class="bn" id="td3-费用减少" style="padding: 0;font-size: 20px;color:#03a7ee;font-weight: bold"></td>
          <td class="bn" id="td3-施工时间减少" style="padding: 0;font-size: 20px;color:#03a7ee;font-weight: bold"></td>
          <td class="bn" id="td3-桥射联作风险降低" style="padding: 0;font-size: 20px;color:#03a7ee;font-weight: bold"></td>
        </tr>
        </tbody>
      </table>
    </div>

  </div>

  <div style="width: 1350px; margin-left: auto; margin-right: auto; margin-top: 0; padding-top: 0">
    <div id="calculatorPie"
         style="height: 400px;width: 1350px; margin-left: 0; margin-bottom: 0; padding-bottom: 0; margin-top: 0; padding-top: 0"/>
  </div>
  <div style="width: 1350px; margin-left: auto; margin-right: auto; margin-top: 0; padding-top: 0; padding-left: 100px">
    <table id="table-4" class="bn b--black table is-bordered" style="font-size: 13px; margin-top: 0; padding-top: 0;">
      <thead>
        <th class="bn" style="width: 180px">压裂段数</th>
        <th class="bn pa2" style="width: 150px">压裂费用</th>
        <th class="bn pa2" style="width: 150px">桥射联作费用</th>
        <th class="bn pa2" style="width: 150px">连油钻塞费用</th>
        <th class="bn pa2" style="width: 160px">桥塞费用</th>
        <th class="bn pa2" style="width: 150px">压裂施工周期</th>
        <th class="bn pa2" style="width: 170px">每次异常事件发生概率-桥塞遇阻或提前坐封</th>
        <th class="bn" >每次异常事件发生概率-射孔枪点火失败</th>
      </thead>
      <tbody>
      <tr>
        <td class="bn" id="td4-before-压裂段数" style="padding:0">25</td>
        <td class="bn pa2" id="td4-before-压裂费用" style="padding:0">593</td>
        <td class="bn pa2" id="td4-before-桥射联作费用" style="padding:0">192</td>
        <td class="bn pa2" id="td4-before-连油钻塞费用" style="padding:0">74</td>
        <td class="bn pa2" id="td4-before-桥塞费用" style="padding:0">26</td>
        <td class="bn pa2" id="td4-before-压裂施工周期" style="padding:0">10.0</td>
        <td class="bn pa2" id="td4-before-桥塞遇阻或提前坐封概率" style="padding:0">21</td>
        <td class="bn" id="td4-before-射孔枪点火失败概率" style="padding:0">21</td>
      </tr>
      <tr>
        <td class="bn" id="td4-after-压裂段数" style="padding:0">13</td>
        <td class="bn pa2" id="td4-after-压裂费用" style="padding:0">308</td>
        <td class="bn pa2" id="td4-after-桥射联作费用" style="padding:0">96</td>
        <td class="bn pa2" id="td4-after-连油钻塞费用" style="padding:0">37</td>
        <td class="bn pa2" id="td4-after-桥塞费用" style="padding:0">13</td>
        <td class="bn pa2" id="td4-after-压裂施工周期" style="padding:0">8.5</td>
        <td class="bn pa2" id="td4-after-桥塞遇阻或提前坐封概率" style="padding:0">11</td>
        <td class="bn" id="td4-after-射孔枪点火失败概率" style="padding:0">11</td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
<link rel="stylesheet" href="https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
<script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.2/FileSaver.min.js"></script>
<script>
  const showMsgOk = (text) => (new Notyf({position: {x: 'right', y: 'top'}})).success(text);
  const showMsgErr = (text) => (new Notyf({position: {x: 'right', y: 'top'}})).error(text);
  const toggleTable2 = () => $('#table-2').toggle();
  $("#btn-setting").click(
      () => toggleTable2()
  );
  $('.only-num').keyup(function () {
    this.value = this.value.replace(/[^0-9\.]/g,'');
  });
  $('.only-int').keyup(function () {
    this.value = this.value.replace(/[^0-9]/g,'');
  });
  $('.input').change(function () {
    refreshResultTable();
    showMsgOk("计算结果已更新");
  });
  $('.input-num').keypress(function(e) {
    if(e.which == 13) {
      refreshResultTable();
    }
  });


  const FORM_DATA = {
    field_原设计中的压裂段数: 0,
    field_合并缩减_优化后的压裂段数: 0,
    field_压裂车费用_N_1: 0,
    field_压裂车费用_N_2: 0,
    field_混砂车费用_N_1: 0,
    field_混砂车费用_N_2: 0,
    field_仪表车费用_N_1: 0,
    field_仪表车费用_N_2: 1, // static
    field_桥射联作费用_N_1: 0,
    field_桥射联作费用_N_2: 1, // static
    field_连油钻塞费用_N_1: 0,
    field_连油钻塞费用_N_2: 1, // static
    field_桥塞费用_N_1: 0,
    field_桥塞费用_N_2: 1, // static
    field_压裂施工速度_N_1: 0,
    field_压裂施工速度_N_2: 1, // static
    field_桥射联作平均耗时_N_1: 0,
    field_桥射联作平均耗时_N_2: 1, // static
    field_桥塞遇阻或提前坐封概率_N_1: 0,
    field_桥塞遇阻或提前坐封概率_N_2: 1, // static
    field_射孔枪点火失败概率_N_1: 0,
    field_射孔枪点火失败概率_N_2: 1, // static
  };
  const CHART_DATA = {
    field_段数减少: 0,
    field_费用减少: 0,
    field_施工时间减少: 0,
    field_桥射联作风险降低: 0,
    beforeOptimized: {
      field_压裂段数: 0,
      field_压裂费用: 0,
      field_桥射联作费用: 0,
      field_连油钻塞费用: 0,
      field_桥塞费用: 0,
      field_压裂施工周期: 0,
      field_桥塞遇阻提前坐封概率: 0,
      field_射孔枪点火失败概率: 0,
    },
    afterOptimized: {
      field_压裂段数: 0,
      field_压裂费用: 0,
      field_桥射联作费用: 0,
      field_连油钻塞费用: 0,
      field_桥塞费用: 0,
      field_压裂施工周期: 0,
      field_桥塞遇阻提前坐封概率: 0,
      field_射孔枪点火失败概率: 0,
    }
  };
  const beforeOptimized = () => {
    const data = [];
    for (const [key, val] of Object.entries(CHART_DATA.beforeOptimized)) {
      if (['field_桥塞遇阻提前坐封概率', 'field_射孔枪点火失败概率'].includes(key)) {
        data.push(val * 100);
      } else {
        data.push(val);
      }
    }
    return data;
  }
  const afterOptimized = () => {
    const data = [];
    for (const [key, val] of Object.entries(CHART_DATA.afterOptimized)) {
      if (['field_桥塞遇阻提前坐封概率', 'field_射孔枪点火失败概率'].includes(key)) {
        data.push(val * 100);
      } else {
        data.push(val);
      }
    }
    return data;
  }

  const refreshResultTable = () => {
    // LOAD FORM DATA
    FORM_DATA.field_原设计中的压裂段数 = Number($('#form-data-原设计中的压裂段数').val());
    FORM_DATA.field_合并缩减_优化后的压裂段数 = Number($('#form-data-合并缩减-优化后的压裂段数').val());
    FORM_DATA.field_压裂车费用_N_1 = Number($('#form-data-压裂车费用-N-1').val());
    FORM_DATA.field_压裂车费用_N_2 = Number($('#form-data-压裂车费用-N-2').val());
    FORM_DATA.field_混砂车费用_N_1 = Number($('#form-data-混砂车费用-N-1').val());
    FORM_DATA.field_混砂车费用_N_2 = Number($('#form-data-混砂车费用-N-2').val());
    FORM_DATA.field_仪表车费用_N_1 = Number($('#form-data-仪表车费用-N-1').val());
    FORM_DATA.field_桥射联作费用_N_1 = Number($('#form-data-桥射联作费用-N-1').val());
    FORM_DATA.field_连油钻塞费用_N_1 = Number($('#form-data-连油钻塞费用-N-1').val());
    FORM_DATA.field_桥塞费用_N_1 = Number($('#form-data-桥塞费用-N-1').val());
    FORM_DATA.field_压裂施工速度_N_1 = Number($('#form-data-压裂施工速度-N-1').val());
    FORM_DATA.field_桥射联作平均耗时_N_1 = Number($('#form-data-桥射联作平均耗时-N-1').val());
    FORM_DATA.field_桥塞遇阻或提前坐封概率_N_1 = Number($('#form-data-桥塞遇阻或提前坐封概率-N-1').val());
    FORM_DATA.field_射孔枪点火失败概率_N_1 = Number($('#form-data-射孔枪点火失败概率-N-1').val());
    // LOAD CHART DATA
    CHART_DATA.beforeOptimized.field_压裂段数 = FORM_DATA.field_原设计中的压裂段数;
    CHART_DATA.afterOptimized.field_压裂段数 = FORM_DATA.field_合并缩减_优化后的压裂段数;

    const _单段压裂费用 = (FORM_DATA.field_压裂车费用_N_1 * FORM_DATA.field_压裂车费用_N_2) + (FORM_DATA.field_混砂车费用_N_1 * FORM_DATA.field_混砂车费用_N_2) + (FORM_DATA.field_仪表车费用_N_1)
    CHART_DATA.beforeOptimized.field_压裂费用 = Math.round(_单段压裂费用 * FORM_DATA.field_原设计中的压裂段数);
    CHART_DATA.afterOptimized.field_压裂费用 = Math.round(_单段压裂费用 * FORM_DATA.field_合并缩减_优化后的压裂段数);

    CHART_DATA.beforeOptimized.field_桥射联作费用 = Math.round(FORM_DATA.field_桥射联作费用_N_1 * (FORM_DATA.field_原设计中的压裂段数 - 1));
    CHART_DATA.afterOptimized.field_桥射联作费用 =  Math.round(FORM_DATA.field_桥射联作费用_N_1 * (FORM_DATA.field_合并缩减_优化后的压裂段数 - 1));

    CHART_DATA.beforeOptimized.field_连油钻塞费用 = Math.round(FORM_DATA.field_连油钻塞费用_N_1 * (FORM_DATA.field_原设计中的压裂段数 - 1));
    CHART_DATA.afterOptimized.field_连油钻塞费用 = Math.round(FORM_DATA.field_连油钻塞费用_N_1 * (FORM_DATA.field_合并缩减_优化后的压裂段数 - 1));

    CHART_DATA.beforeOptimized.field_桥塞费用 = Math.round(FORM_DATA.field_桥塞费用_N_1 * (FORM_DATA.field_原设计中的压裂段数 - 1));
    CHART_DATA.afterOptimized.field_桥塞费用 = Math.round(FORM_DATA.field_桥塞费用_N_1 * (FORM_DATA.field_合并缩减_优化后的压裂段数 - 1));

    const _原周期 = FORM_DATA.field_原设计中的压裂段数 / FORM_DATA.field_压裂施工速度_N_1;
    CHART_DATA.beforeOptimized.field_压裂施工周期 = _原周期.toFixed(1);
    CHART_DATA.afterOptimized.field_压裂施工周期 = (_原周期 - (FORM_DATA.field_桥射联作平均耗时_N_1 / 24) * (FORM_DATA.field_原设计中的压裂段数 - FORM_DATA.field_合并缩减_优化后的压裂段数)).toFixed(1)

    const _before_桥塞遇阻提前坐封概率 = 1 - Math.pow((1 - FORM_DATA.field_桥塞遇阻或提前坐封概率_N_1 / 100), FORM_DATA.field_原设计中的压裂段数 - 1);
    const _after_桥塞遇阻提前坐封概率 = 1 - Math.pow((1 - FORM_DATA.field_桥塞遇阻或提前坐封概率_N_1 / 100), FORM_DATA.field_合并缩减_优化后的压裂段数 - 1);
    CHART_DATA.beforeOptimized.field_桥塞遇阻提前坐封概率 = _before_桥塞遇阻提前坐封概率; //E9
    CHART_DATA.afterOptimized.field_桥塞遇阻提前坐封概率 = _after_桥塞遇阻提前坐封概率; //F9

    const _before_射孔枪点火失败概率 = 1 - Math.pow((1 - FORM_DATA.field_射孔枪点火失败概率_N_1 / 100), FORM_DATA.field_原设计中的压裂段数 - 1);
    const _after_射孔枪点火失败概率 = 1 - Math.pow((1 - FORM_DATA.field_射孔枪点火失败概率_N_1 / 100), FORM_DATA.field_合并缩减_优化后的压裂段数 - 1);
    CHART_DATA.beforeOptimized.field_射孔枪点火失败概率 = _before_射孔枪点火失败概率; //E10
    CHART_DATA.afterOptimized.field_射孔枪点火失败概率 = _after_射孔枪点火失败概率; //F10

    CHART_DATA.field_段数减少 = FORM_DATA.field_原设计中的压裂段数 - FORM_DATA.field_合并缩减_优化后的压裂段数;
    const _原费用 = CHART_DATA.beforeOptimized.field_压裂费用 + CHART_DATA.beforeOptimized.field_桥射联作费用 + CHART_DATA.beforeOptimized.field_连油钻塞费用 + CHART_DATA.beforeOptimized.field_桥塞费用;
    const _现费用 =  CHART_DATA.afterOptimized.field_压裂费用 + CHART_DATA.afterOptimized.field_桥射联作费用 + CHART_DATA.afterOptimized.field_连油钻塞费用 + CHART_DATA.afterOptimized.field_桥塞费用;
    CHART_DATA.field_费用减少 = _原费用 - _现费用;
    CHART_DATA.field_施工时间减少 = (CHART_DATA.beforeOptimized.field_压裂施工周期 - CHART_DATA.afterOptimized.field_压裂施工周期).toFixed(1);
    const _原风险 = 1 - ((1-_before_桥塞遇阻提前坐封概率) * (1-_before_射孔枪点火失败概率));
    const _现风险 = 1 - ((1-_after_桥塞遇阻提前坐封概率) * (1-_after_射孔枪点火失败概率));
    CHART_DATA.field_桥射联作风险降低 =  _原风险 - _现风险;
    // LOAD TABLE
    $('#td4-before-压裂段数').text(`${CHART_DATA.beforeOptimized.field_压裂段数}段`);
    $('#td4-before-压裂费用').text(`${CHART_DATA.beforeOptimized.field_压裂费用}万元`);
    $('#td4-before-桥射联作费用').text(`${CHART_DATA.beforeOptimized.field_桥射联作费用}万元`);
    $('#td4-before-连油钻塞费用').text(`${CHART_DATA.beforeOptimized.field_连油钻塞费用}万元`);
    $('#td4-before-桥塞费用').text(`${CHART_DATA.beforeOptimized.field_桥塞费用}万元`);
    $('#td4-before-压裂施工周期').text(`${CHART_DATA.beforeOptimized.field_压裂施工周期}天`);
    $('#td4-before-桥塞遇阻或提前坐封概率').text(`${Math.round(CHART_DATA.beforeOptimized.field_桥塞遇阻提前坐封概率 * 100)}%`);
    $('#td4-before-射孔枪点火失败概率').text(`${Math.round(CHART_DATA.beforeOptimized.field_射孔枪点火失败概率 * 100)}%`);
    $('#td4-after-压裂段数').text(`${CHART_DATA.afterOptimized.field_压裂段数}段`);
    $('#td4-after-压裂费用').text(`${CHART_DATA.afterOptimized.field_压裂费用}万元`);
    $('#td4-after-桥射联作费用').text(`${CHART_DATA.afterOptimized.field_桥射联作费用}万元`);
    $('#td4-after-连油钻塞费用').text(`${CHART_DATA.afterOptimized.field_连油钻塞费用}万元`);
    $('#td4-after-桥塞费用').text(`${CHART_DATA.afterOptimized.field_桥塞费用}万元`);
    $('#td4-after-压裂施工周期').text(`${CHART_DATA.afterOptimized.field_压裂施工周期}天`);
    $('#td4-after-桥塞遇阻或提前坐封概率').text(`${Math.round(CHART_DATA.afterOptimized.field_桥塞遇阻提前坐封概率 * 100)}%`);
    $('#td4-after-射孔枪点火失败概率').text(`${Math.round(CHART_DATA.afterOptimized.field_射孔枪点火失败概率 * 100)}%`);
    $('#td3-段数减少').text(`${CHART_DATA.field_段数减少}段`);
    $('#td3-费用减少').text(`${CHART_DATA.field_费用减少}万元`);
    $('#td3-施工时间减少').text(`${CHART_DATA.field_施工时间减少}天`);
    $('#td3-桥射联作风险降低').text(`${(CHART_DATA.field_桥射联作风险降低 * 100).toFixed(2)}%`);
    drawBarChart()
  };

  const drawBarChart = () => {
    const cht = echarts.init(document.getElementById('calculatorPie'));
    const labelFormatter = (params) => {
      if (params.name === "压裂段数") {
        return params.value + '段'
      }
      if (params.name === "压裂施工周期") {
        return params.value + '天'
      }
      if (params.name === '桥塞遇阻或提前坐封概率' || params.name === '射孔枪点火失败概率') {
        return Math.round(params.value) + '%'
      }
      return params.value + '万元'
    };
    const option = {
      grid: {bottom: '0', right: '0'},
      legend: {
        data: ['优化段数前(常规压裂)', '优化段数后(零桥塞压裂TM)'],
        orient: 'vertical',
        top: 30,
        right: 20,
        textStyle: {
          color: 'white'
        }
      },
      xAxis: {
        show: false,
        type: 'category',
        nameTextStyle: {fontSize: 3},
        nameGap: 3,
        axisLabel: {interval: 0},
        data: ['压裂段数', '压裂费用', '桥射联作费用', '连油钻塞费用', '桥塞费用', '压裂施工周期', '桥塞遇阻或提前坐封概率', '射孔枪点火失败概率']
      },
      yAxis: {show: false},
      series: [
        {
          name: '优化段数前(常规压裂)',
          type: 'bar',
          data: beforeOptimized(),
          barGap: '5%',
          barWidth: '25%',
          itemStyle: {color: '#747474'},
          label: {normal: {show: true, position: 'top', formatter: labelFormatter, color: "white"}},
        },
        {
          name: '优化段数后(零桥塞压裂TM)',
          type: 'bar',
          data: afterOptimized(),
          barGap: '5%',
          barWidth: '25%',
          itemStyle: {color: '#03a7ee'},
          label: {normal: {show: true, position: 'top', formatter: labelFormatter, color: "white"}},
        },
      ]
    };
    cht.setOption(option);
  };
  refreshResultTable();
</script>
<style>
  .button-vertical-center {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .input {
    animation-name: unset;
    animation-fill-mode: unset;
    animation-delay: unset;
    visibility: unset;
  }
  .is-bordered {
    color: white;
    /*border-collapse: separate;*/
    /*border-spacing: 0; !* 这将确保单元格之间没有额外的空间 *!*/
    border-color: white;
  }
  .pa2 {
    border-left: 1px solid black;
    border-right: 1px solid black;
    border-color: white;
    padding: 5px; /* 为了美观，添加一些内边距 */
  }
</style>
